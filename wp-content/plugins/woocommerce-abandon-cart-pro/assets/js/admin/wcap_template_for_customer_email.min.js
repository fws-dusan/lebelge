function wcap_add_new_rule_row(e){document.getElementById("wcap-rule-list-header").style.display="table-header-group",(e=document.getElementById(e)).remove();var t=document.getElementsByClassName("wcap-rule-list"),a=t[0].tBodies[0].rows.length+1,r=t[0].getAttribute("data-row"),c=document.getElementById("wcap-rule-list-body").insertRow();c.id=a;var s="wcap_rule_type_"+a,l="wcap_rule_condition_"+a,u="wcap_rule_value_"+a,i="wcap_rule_delete_"+a,n=(r=(r=(r=(r=(r=r.replace(/'wcap_rule_type_'/g,s)).replace(/'wcap_rule_condition_'/g,l)).replace(/'wcap_rule_value_'/g,u)).replace(/'wcap_rule_delete_'/g,i)).replace(/'<td>'/g,"")).split("</td>"),d=c.insertCell(0);d.innerHTML=n[0];var o=c.insertCell(1);o.innerHTML=n[1];var _=c.insertCell(2);_.innerHTML=n[2],c.insertCell(3).innerHTML=n[3],d.style.width="25%",o.style.width="23%",_.style.width="30%"}function wcap_rule_values(e){var t=document.getElementById(e).value,a=e.substr(-1),r="wcap_rule_value_"+a,c=document.getElementById(r),s="wcap_rule_condition_"+a,l=document.getElementById(s);if(jQuery("#"+r).hasClass("select2-hidden-accessible")){jQuery("#"+r).select2("destroy");document.querySelector(r);const e=document.createElement("select");e.setAttribute("class","wcap_rule_value"),e.setAttribute("id",r),e.setAttribute("name",r),c.parentNode.replaceChild(e,c),c=document.getElementById(r)}if("INPUT"==c.nodeName&&"payment_gateways"==t){document.querySelector(r);const e=document.createElement("select");e.setAttribute("class","wcap_rule_value"),e.setAttribute("id",r),e.setAttribute("name",r),c.parentNode.replaceChild(e,c),c=document.getElementById(r)}if(""!==t){for(;l.options.length>0;)l.remove(0);switch(t){case"cart_items_count":case"cart_total":var u=Object.entries(wcap_email_params.wcap_counts);for(const[e,t]of u){let a=new Option(`${t}`,`${e}`);l.add(a,void 0)}l.removeAttribute("style");break;default:var i=Object.entries(wcap_email_params.wcap_cond_includes);for(const[e,t]of i){let a=new Option(`${t}`,`${e}`);l.add(a,void 0)}l.setAttribute("style","width: 80%;")}if("SELECT"===c.nodeName){for(;c.options.length>0;)c.remove(0);c.removeAttribute("onChange")}switch(t){case"send_to":c.setAttribute("onChange","wcap_rule_value_updated( this.id )"),c.setAttribute("class","wcap_rule_value wc-product-search"),c.setAttribute("multiple","multiple"),c.setAttribute("data-action","wcap_json_find_send_to"),c.setAttribute("name",r+"[]"),c.setAttribute("data-placeholder",wcap_email_params.wcap_send_to_select),c.setAttribute("style","width:90%;"),jQuery(".wc-product-search").selectWoo(),jQuery(document.body).trigger("wc-enhanced-select-init");break;case"cart_items_count":case"cart_total":document.querySelector(r);const e=document.createElement("input");e.setAttribute("class","wcap_rule_value"),e.setAttribute("type","number"),e.setAttribute("id",r),e.setAttribute("name",r),e.min=1,c.parentNode.replaceChild(e,c);break;case"payment_gateways":var n=Object.entries(wcap_email_params.wcap_payment_gateways);for(const[e,t]of n){let a=new Option(`${t}`,`${e}`);c.add(a,void 0)}break;case"cart_items":c.setAttribute("class","wcap_rule_value wc-product-search"),c.setAttribute("multiple","multiple"),c.setAttribute("data-action","wcap_json_find_products"),c.setAttribute("name",r+"[]"),c.setAttribute("data-placeholder",wcap_email_params.wcap_product_select),c.setAttribute("style","width:90%;"),jQuery(".wc-product-search").selectWoo(),jQuery(document.body).trigger("wc-enhanced-select-init");break;case"coupons":c.setAttribute("class","wcap_rule_value wc-product-search"),c.setAttribute("multiple","multiple"),c.setAttribute("data-action","wcap_json_find_coupons"),c.setAttribute("name",r+"[]"),c.setAttribute("data-placeholder",wcap_email_params.wcap_coupon_select),c.setAttribute("style","width:90%;"),jQuery(".wc-product-search").selectWoo(),jQuery(document.body).trigger("wc-enhanced-select-init");break;case"product_cat":var d=document.getElementById(a).cells[2];console.log(d),c.setAttribute("class","wcap_rule_value wc-product-search"),c.setAttribute("multiple","multiple"),c.setAttribute("data-action","wcap_json_find_product_cat"),c.setAttribute("name",r+"[]"),c.setAttribute("data-placeholder",wcap_email_params.wcap_prod_cat_select),c.setAttribute("style","width:90%;"),jQuery(".wc-product-search").selectWoo(),jQuery(document.body).trigger("wc-enhanced-select-init");break;case"product_tag":c.setAttribute("class","wcap_rule_value wc-product-search"),c.setAttribute("multiple","multiple"),c.setAttribute("data-action","wcap_json_find_product_tag"),c.setAttribute("name",r+"[]"),c.setAttribute("data-placeholder",wcap_email_params.wcap_prod_tag_select),c.setAttribute("style","width:90%;"),jQuery(".wc-product-search").selectWoo(),jQuery(document.body).trigger("wc-enhanced-select-init");break;case"cart_status":c.setAttribute("class","wcap_rule_value wc-product-search"),c.setAttribute("multiple","multiple"),c.setAttribute("data-action","wcap_json_find_cart_status"),c.setAttribute("name",r+"[]"),c.setAttribute("data-placeholder",wcap_email_params.wcap_status_select),c.setAttribute("style","width:90%;"),jQuery(".wc-product-search").selectWoo(),jQuery(document.body).trigger("wc-enhanced-select-init")}}}function wcap_delete_rule_row(e){var t=e.substr(-1),a=document.getElementsByClassName("wcap-rule-list")[0].tBodies[0].rows.length;if(1==a)(r=document.createElement("a")).href="javascript:void(0)",r.classList.add("wcap_add_rule_button"),r.id="add_new",r.onclick=function(){wcap_add_new_rule_row("add_new")},r.innerHTML="<i class='fa fa-plus fa-lg fa-fw'></i> Add Rule",document.getElementById("wcap_rule_list_footer").append(r),document.getElementById("wcap-rule-list-header").style.display="none";else if(t==a){var r,c=document.getElementById(t-1).cells[3];(r=document.createElement("a")).classList.add("wcap_add_rule_button"),r.id="add_new",r.onclick=function(){wcap_add_new_rule_row("add_new")},r.href="javascript:void(0)",r.innerHTML="<i class='fa fa-plus fa-lg fa-fw'></i> Add Rule",c.append(r)}var s=document.getElementById(t);s.parentNode.removeChild(s)}function wcap_rule_value_updated(e){var t=document.getElementById(e),a=getSelectValues(t),r=t.parentNode,c=document.getElementById("wcap_rules_email_addresses");if(-1!=a.indexOf("email_addresses")&&null===c){var s=document.createElement("textarea");s.setAttribute("rows",3),s.setAttribute("cols",35),s.setAttribute("name","wcap_rules_email_addresses"),s.setAttribute("id","wcap_rules_email_addresses"),s.setAttribute("style","margin-top: 10px;"),s.setAttribute("placeholder","Please enter email addresses separated by a comma"),s.innerHTML="",r.append(s)}else-1==a.indexOf("email_addresses")&&null!==c&&c.parentNode.removeChild(c)}function getSelectValues(e){for(var t,a=[],r=e&&e.options,c=0,s=r.length;c<s;c++)(t=r[c]).selected&&a.push(t.value||t.text);return a}jQuery(function(e){e(document).on("change","#wcap_email_action",function(){"wcap_email_others"==this.value?e(".wcap_other_emails").fadeIn():e(".wcap_other_emails").fadeOut()})});